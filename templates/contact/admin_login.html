{% load static %}
<!DOCTYPE html>
<html lang="{{ lang }}">
<head>
    <meta charset="UTF-8">
    <title>{% if lang == 'pl' %}Panel Admina - Logowanie{% else %}Admin Login{% endif %}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" href="{% static 'img/zet1.png' %}" type="image/png">
    <link rel="stylesheet" href="{% static 'css/public.css' %}">
</head>
<body class="admin-login-page">
<header class="site-header">
    <div class="site-branding">
        <img src="{% static 'img/zet3.avif' %}" alt="ZETOM Katowice" class="site-logo">
        <div>
            <h1 class="site-title">ZETOM Katowice</h1>
            <p class="site-subtitle">
                {% if lang == 'pl' %}
                    Badania • Certyfikacja • Kontrola techniczna
                {% else %}
                    Testing • Certification • Technical inspections
                {% endif %}
            </p>
        </div>
    </div>
    <nav class="site-nav">
        <a href="{% url 'contact:index' %}?lang={{ lang }}#about">{% if lang == 'pl' %}O nas{% else %}About{% endif %}</a>
        <a href="{% url 'contact:index' %}?lang={{ lang }}#services">{% if lang == 'pl' %}Usługi{% else %}Services{% endif %}</a>
        <a href="{% url 'contact:index' %}?lang={{ lang }}#contact">{% if lang == 'pl' %}Kontakt{% else %}Contact{% endif %}</a>
    </nav>
    <div class="site-header__actions">
        <div class="lang-switcher">
            <a href="{% url 'contact:login' %}?lang=pl" class="{% if lang == 'pl' %}is-active{% endif %}">PL</a>
            <a href="{% url 'contact:login' %}?lang=en" class="{% if lang != 'pl' %}is-active{% endif %}">EN</a>
        </div>
    </div>
</header>
<main class="admin-login-page__main">
    <section class="admin-login" aria-labelledby="admin-login-title">
        <div class="admin-login__intro">
            <h2 class="admin-login__title" id="admin-login-title">{% if lang == 'pl' %}Panel administratora{% else %}Admin panel{% endif %}</h2>
            <p class="admin-login__description">{% if lang == 'pl' %}Wprowadź hasło, aby uzyskać dostęp do panelu.{% else %}Enter the password to access the panel.{% endif %}</p>
            {% if blocked %}
    <div class="admin-login__blocked">
        {% if lang == 'pl' %}
            <p style="color:red;">Zablokowano logowanie na 5 minut.</p>
            <p>Pozostały czas: <span id="timeLeft">{{ time_left }}</span></p>
        {% else %}
            <p style="color:red;">Login temporarily blocked for 5 minutes.</p>
            <p>Time left: <span id="timeLeft">{{ time_left }}</span></p>
        {% endif %}
    </div>
    <script>
        // Обратный отсчёт в реальном времени
        let timeParts = "{{ time_left }}".split(":");
        let minutes = parseInt(timeParts[0]);
        let seconds = parseInt(timeParts[1]);
        let total = minutes * 60 + seconds;

        const timer = setInterval(() => {
            if (total <= 0) {
                clearInterval(timer);
                document.getElementById("timeLeft").innerText = "00:00";
                location.reload();
                return;
            }
            total--;
            let m = String(Math.floor(total / 60)).padStart(2, "0");
            let s = String(total % 60).padStart(2, "0");
            document.getElementById("timeLeft").innerText = `${m}:${s}`;
        }, 1000);
    </script>
{% endif %}

        </div>
        <form method="post" action="{% url 'contact:login' %}?lang={{ lang }}" class="admin-login__form">
            {% csrf_token %}
            <input type="hidden" name="next" value="{{ back_url }}">
            <label class="admin-login__label" for="{{ form.password.id_for_label }}">{% if lang == 'pl' %}Hasło{% else %}Password{% endif %}</label>
            {{ form.password }}
            {% if form.password.errors %}
                <div class="admin-login__error">{{ form.password.errors.0 }}</div>
            {% endif %}
            <div class="admin-login__actions">
                <button type="submit" class="button button--primary">{% if lang == 'pl' %}Zaloguj{% else %}Log in{% endif %}</button>
                <a href="{{ back_url }}" class="admin-login__back">{% if lang == 'pl' %}Wróć{% else %}Go back{% endif %}</a>
            </div>
        </form>
    </section>
</main>
</body>
</html>

